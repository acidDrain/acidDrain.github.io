<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.b159a09df73ca641da42.css">html{box-sizing:border-box;font-size:100%;margin:0;padding:0}*,:after,:before{box-sizing:inherit}body{margin:0;padding:0;color:#222;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Lato,Helvetica,Arial,sans-serif;line-height:1.5;overflow-y:scroll;height:100%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}button::-moz-focus-inner{border:0}.header{display:flex;flex-direction:column;align-items:center}.header,h1,h2,h3,h4,h5,h6{font-family:serif}h2,h3,h4,h5,h6{padding:1em .5em}h2{margin-bottom:0}a,a:active,a:focus,a:hover,a:visited{font-weight:900;color:#00008b}.postTitle{width:100%;display:flex}.postsList{display:flex;flex-direction:column;margin:auto;max-width:55vw}.postNav{display:flex;justify-content:space-between;padding:2rem 0}.excerpt{display:flex;width:100%}.blogpost{margin:auto;max-width:85ch;display:flex;flex-direction:column}p{margin:1.3rem 0 1.3rem 2rem;text-align:left}img{height:34rem;width:auto;padding:1rem}blockquote{color:#6a737d;border-left:.25em solid #dfe2e5;padding:0 1em;line-height:1.3em}li{padding:.4em}code{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,"monospace";word-wrap:break-word;background-color:rgba(27,31,35,.05);border-radius:3px;line-height:1.5;font-size:85%;overflow:auto;padding:.2em .4em;box-sizing:border-box}@media only screen and (max-width:768px){.blogpost,.container,.postsList{max-width:45ch;margin:auto;display:flex}img{width:34rem;height:auto;padding:1rem}}</style><meta name="generator" content="Gatsby 2.18.5"/><link as="script" rel="preload" href="/webpack-runtime-0f1103ad0707782b03f8.js"/><link as="script" rel="preload" href="/commons-cd4c3864b5bf863603b7.js"/><link as="script" rel="preload" href="/app-4fc3794d452306b2eb81.js"/><link as="script" rel="preload" href="/styles-d65c8ba6bde2fe23af55.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-7b6863230a41beff2ea8.js"/><link as="fetch" rel="preload" href="/page-data/yubikeys/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="blogpost"><div class="postNav"><div><a href="/mr-robot-notes">Prev Post</a></div><div><a href="/">Home</a></div><div><a href="/sharing-useful-content">Next Post</a></div></div><h1>YubiKeys Aren&#x27;t A New Hardware Token</h1><div><p>This post is about security keys and passwordless authentication. A popular implementation of this is YubiKey, which has just announced biometrics capabilities.</p>
<p>YubiKeys aren't a hardware token. They're a radical shift in the fundamentals of how we do trust, authentication, and identity. You can even <a href="https://www.yubico.com/2015/11/yubico-docker-codesign/">code-sign your docker images</a> with them! It supports OTP (One-Time Password), PKI (Public Key Infrastructure, used for encryption and authentication), and <code>U2F</code>/<code>FIDO2</code>/<code>WebAuthn</code>.</p>
<p>I'm going to focus on implementation with the standard/open API <code>WebAuthn</code>.</p>
<p>YubiKey and <code>WebAuthn</code> work together to implement strict controls and checks that provide better guarantees about trust and identity. They also enable passwordless multi-factor authentication that, at least so far, <a href="https://krebsonsecurity.com/2018/07/google-security-keys-neutralized-employee-phishing/">completely mitigates phishing attacks</a>. It seems to have eliminated an entire class of security threat.</p>
<p>How often do we see an entire threat vector eliminated? Once or twice in a lifetime?</p>
<p>Here's a little background with a high-level description of how it works.</p>
<h2><code>FIDO</code> and <code>WebAuthn</code></h2>
<p>The <code>FIDO</code> ("Fast IDentity Online") Alliance is an open industry association focused on authentication an identity.</p>
<p>FIDO members include (from the <a href="https://en.wikipedia.org/wiki/FIDO_Alliance#Members">Wikipedia page</a>):</p>
<blockquote>
<p>FIDO was founded by Agnitio, Infineon, Lenovo, Nok Nok Labs, PayPal and Validity Sensors.<sup>[2]</sup> By the end of September 2016, FIDO members totaled more than 260, including a board made up of the Aetna, Alibaba Group, Amazon, American Express, ARM, Bank of America, BC Card, Broadcom, CrucialTec, Daon, Egis Technology, Feitian, Gemalto, Google, HYPR, Infineon, Intel, ING, Lenovo, MasterCard, Microsoft, Nok Nok Labs, NTT DoCoMo, NXP Semiconductors, Oberthur Technologies, PayPal, Qualcomm, RSA, Samsung Electronics, Synaptics, USAA, Visa, VMware, OneSpan and Yubico.<sup>[3]</sup> A full list of members is available on the official website.</p>
</blockquote>
<p>FIDO's released the <code>U2F</code> (Universal 2nd Factor) protocol and submitted it to <code>W3C</code> (World Wide Web Consortium, an internet standards organization) as a proposed standard. The official, published standard is now called <code>WebAuthn</code> (WebAuthentication).</p>
<h2>YubiKey</h2>
<p>Yubico, the company that makes the YubiKey, is a "Board Level Sponsor" of the FIDO Alliance and (I believe) the first authenticator solution to support <code>U2F</code> and <code>WebAuthn</code>.</p>
<h2>Registration</h2>
<p>The <code>WebAuthn</code> standard starts with the user registering their authenticator (such as YubiKey). Once that device is initially associated with an owner/identity, there is an initial registration that occurs seamlessly per application/service.</p>
<p>From a high-level perspective, the process looks like this:</p>
<ol>
<li>When a user first logs onto a service - they provide their username, and it's passed to the relying party (service/app we are signing on to use). No password is entered or exchanged.</li>
<li>The server sends back a challenge key for the user for one-time registration and provides its relying party info - the client verifies this for authenticity, then checks against it any time the user connects to this app again.</li>
<li>The authenticator (YubiKey) is triggered to perform user verification and consent (pressing the button, entering pin, biometrics).</li>
<li>Authenticator - YubiKey - generates and exchanges a public-private key-pair that is explicitly associated with this app via a credential ID. The credential ID and public key are combined to create an "attestation object," and provided to the relying party/service. The attestation object is a mechanism to do verification checks of the authenticator's integrity.</li>
</ol>
<p><strong>No password, PIN, or anything else has been exchanged or can be phished/spoofed.</strong></p>
<ol start="5">
<li>Finally, the server/relying party verifies the challenge-response and signatures are good and registers the client/authenticator.</li>
</ol>
<h2>Authentication</h2>
<p>After the initial registration, we can authenticate. Conceptually, the process looks like this:</p>
<ol>
<li>User signs on by providing their username to the server (relying party).</li>
<li>Server provides a challenge, and it's relying party info</li>
<li>The client verifies the relying party ID against the origin. Then the YubiKey is given the domain name the challenge is associated with and requests consent from the user. If the domain doesn't match the data saved during registration, the server/relying party is considered a risk and not trusted.</li>
</ol>
<p><strong>That last point is a very crucial distinction and why YubiKey/WebAuthn hard counter phishing attacks.</strong> The YubiKey has the server/relying party's domain and info from registration stored directly. If an attacker tries to trick the user into entering credentials into a spoofed site, the authenticator fails the verification check, helping to eliminate the weakest-link - untrained or careless users, or even experienced users duped by a sophisticated counterfeit.</p>
<ol start="4">
<li>The authenticator/YubiKey creates and sends a signed assertion and authenticator data. These are derived from the key exchange during registration.</li>
<li>Client/browser forwards auth data from YubiKey/authenticator and includes the PublicKey associated with the service/relying party.</li>
<li>The server/ relying party validates the challenge and checks the keys/signatures against its records from registration. If all checks succeed, the user is authenticated and is verified/trusted. And we can be confident of this. No one entered a password or struggled to get their phone out to authorize a push.</li>
</ol>
<p>So, the service and the user mutually can be confident of their authenticity/integrity, and that the interactions are intentional via multi-factor authentication.</p>
<p>Hopefully, this has helped bring some awareness and understanding, and hopefully, excitement about how game-changing this is!</p></div><div class="postNav"><div><a href="/mr-robot-notes">Prev Post</a></div><div><a href="/">Home</a></div><div><a href="/sharing-useful-content">Next Post</a></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/yubikeys";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-4fc3794d452306b2eb81.js"],"component---src-templates-all-tags-index-js":["/component---src-templates-all-tags-index-js-1c43bda09f52d2418613.js"],"component---src-templates-single-tag-index-js":["/component---src-templates-single-tag-index-js-24f326b592a0540c62fe.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-7b6863230a41beff2ea8.js"],"component---src-pages-index-js":["/component---src-pages-index-js-8993e90960e9385ada49.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-7b6863230a41beff2ea8.js" async=""></script><script src="/styles-d65c8ba6bde2fe23af55.js" async=""></script><script src="/app-4fc3794d452306b2eb81.js" async=""></script><script src="/commons-cd4c3864b5bf863603b7.js" async=""></script><script src="/webpack-runtime-0f1103ad0707782b03f8.js" async=""></script></body></html>